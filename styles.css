@supports (padding-top: env(safe-area-inset-top)) {
    body { padding-top: max(20px, env(safe-area-inset-top)) !important; }
}

body {
    margin: 0;
    padding: 20px;
    min-height: 100dvh;
    background: var(--tg-theme-bg-color, #0d0d0d);
    color: var(--tg-theme-text-color, #ffffff);
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    transition: background 0.3s, color 0.3s;
}

.container { max-width: 600px; margin: 0 auto; padding: 20px 0 60px; }

.rounds-control {
    margin: 10px 0 40px;
    display: flex; justify-content: center; align-items: center; gap: 30px; font-size: 28px; font-weight: bold;
}
.rounds-control button {
    width: 56px; height: 56px; border: none; border-radius: 50%;
    background: var(--tg-theme-button-color, #2481ff);
    color: #fff; font-size: 36px; cursor: pointer;
    box-shadow: 0 6px 20px rgba(36,129,255,0.4);
}
.rounds-control button:active { transform: scale(0.92); }

.progress-container { width: 80%; max-width: 420px; height: 8px; background: rgba(255,255,255,0.15); border-radius: 4px; margin: 30px auto; overflow: hidden; }
.progress-bar { width: 0; height: 100%; background: var(--tg-theme-button-color, #2481ff); border-radius: 4px; transition: width 0.4s ease; }

.breath-circle {
    width: 260px; height: 260px; border-radius: 50%; margin: 40px auto;
    background: var(--tg-theme-button-color, #2481ff);
    color: #fff; display: flex; align-items: center; justify-content: center;
    cursor: pointer; font-size: 34px; font-weight: 600;
    box-shadow: 0 12px 40px rgba(36,129,255,0.5);
    transition: all 0.3s;
}
.breath-circle:active { transform: scale(0.95); }
.breath-circle.breathing-in { animation: breathIn 2s ease-in-out; }
.breath-circle.breathing-out { animation: breathOut 2s ease-in-out; background: #ff3b30; box-shadow: 0 12px 40px rgba(255,59,48,0.5); }

@keyframes breathIn { from { transform: scale(1); } to { transform: scale(1.3); } }
@keyframes breathOut { from { transform: scale(1.3); } to { transform: scale(1); } }

#phaseText { font-size: 22px; text-align: center; min-height: 60px; margin: 20px 0; line-height: 1.4; }
#timer { font-size: 64px; font-weight: bold; text-align: center; letter-spacing: -2px; }
#roundInfo { font-size: 20px; text-align: center; margin-top: 20px; opacity: 0.9; }

.stats-container, .achievements-container {
    margin: 40px 0; padding: 24px; background: var(--tg-theme-secondary-bg-color, rgba(255,255,255,0.08));
    border-radius: 20px; backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.05);
}
.stats-tabs { display: flex; justify-content: center; gap: 16px; margin-bottom: 24px; }
.stats-tab { padding: 12px 28px; border: none; border-radius: 30px; background: transparent; color: rgba(255,255,255,0.6); cursor: pointer; font-weight: 500; }
.stats-tab.active { background: var(--tg-theme-button-color, #2481ff); color: #fff; }

.stat-item { display: flex; justify-content: space-between; padding: 14px 0; border-bottom: 1px solid rgba(255,255,255,0.08); }
.stat-item:last-child { border: none; }
.stat-value { font-size: 24px; font-weight: bold; }

.chart-container { height: 300px; margin-top: 20px; background: rgba(0,0,0,0.2); border-radius: 12px; padding: 10px; }

.achievement {
    display: flex; align-items: center; gap: 16px; padding: 16px;
    background: rgba(255,255,255,0.05); border-radius: 16px; margin-bottom: 12px;
}
.achievement-icon { font-size: 36px; }
.achievement-title { font-weight: 600; }

@media (max-width: 480px) {
    .breath-circle { width: 220px; height: 220px; }
    #timer { font-size: 52px; }
}
@keyframes recoveryPulse {
    0%   { transform: scale(1);   box-shadow: 0 0 20px rgba(102, 126, 234, 0.6); }
    50%  { transform: scale(1.15); box-shadow: 0 0 40px rgba(118, 75, 162, 0.8); }
    100% { transform: scale(1);   box-shadow: 0 0 20px rgba(102, 126, 234, 0.6); }
}
